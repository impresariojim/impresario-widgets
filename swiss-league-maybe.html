<script>
  // ==============================
  // CONFIG AREA – CHANGE FOR NEW LEAGUES
  // ==============================

  const clubNames = [
    "BSC Young Boys",
    "FC Basel 1893",
    "FC St. Gallen 1879",
    "FC Zurich",
    "FC Luzern",
    "Servette FC",
    "FC Sion",
    "FC Winterthur",
    "FC Lausanne-Sport",
    "Grasshopper Club Zurich",
    "FC Lugano",
    "Yverdon Sport FC"
  ];

  const capacities = [31500, 38512, 20660, 26104, 15680, 30084, 14850, 8700, 12544, 26104, 4900, 4200];
  const sellThrough = [90.4, 67.9, 87.5, 58.3, 77.0, 33.0, 66.9, 92.7, 55.0, 26.4, 79.2, 65.9];

  // index of focus club (Servette)
  const highlightIndex = 5;
  const xMax = 40000;

  // ==============================
  // DATA TRACES
  // ==============================

  // Only label the highlighted club; others show label on hover only
  const pointLabels = clubNames.map((name, i) =>
    i === highlightIndex ? name : ""
  );

  const markerColors = clubNames.map((_, i) =>
    i === highlightIndex ? "#D5C393" : "rgba(7,56,94,0.35)"
  );

  const markerSizes = clubNames.map((_, i) =>
    i === highlightIndex ? 16 : 8
  );

  const clubsTrace = {
    type: "scatter",
    mode: "markers+text",
    name: "Clubs",
    x: capacities,
    y: sellThrough,
    text: pointLabels,
    textposition: "top center",
    textfont: {
      family: "Montserrat, sans-serif",
      size: 10,
      color: "#1A1A1A"
    },
    marker: {
      color: markerColors,
      size: markerSizes,
      line: { color: "#07385E", width: 1 }
    },
    hovertemplate:
      "<b>%{customdata}</b><br>" +
      "Capacity: %{x}<br>" +
      "Sell-through: %{y:.1f}%<extra></extra>",
    customdata: clubNames
  };

  const line100Trace = {
    type: "scatter",
    mode: "lines",
    x: [0, xMax],
    y: [100, 100],
    line: {
      color: "rgba(0,0,0,0.35)",
      width: 1,
      dash: "dot"
    },
    hoverinfo: "skip",
    showlegend: false
  };

  // ==============================
  // LAYOUT – STRIPPED DOWN
  // ==============================

  const layout = {
    margin: { l: 70, r: 20, t: 20, b: 60 },
    paper_bgcolor: "rgba(0,0,0,0)",
    plot_bgcolor: "#FFFFFF",

    showlegend: false,

    xaxis: {
      title: {
        text: "Stadium capacity",
        font: { family: "Montserrat, sans-serif", size: 12, color: "#1A1A1A" }
      },
      tickfont: { family: "Montserrat, sans-serif", size: 10, color: "#555555" },
      gridcolor: "rgba(0,0,0,0)",      // no gridlines
      linecolor: "rgba(0,0,0,0.5)",
      linewidth: 0.8,
      mirror: true,
      rangemode: "tozero"
    },
    yaxis: {
      title: {
        text: "Average league sell-through (%)",
        font: { family: "Montserrat, sans-serif", size: 12, color: "#1A1A1A" }
      },
      tickfont: { family: "Montserrat, sans-serif", size: 10, color: "#555555" },
      gridcolor: "rgba(0,0,0,0)",      // no gridlines
      linecolor: "rgba(0,0,0,0.5)",
      linewidth: 0.8,
      mirror: true,
      range: [0, 105]
    },

    annotations: [
      {
        x: xMax,
        y: 100,
        xref: "x",
        yref: "y",
        text: "100% of capacity",
        showarrow: false,
        xanchor: "right",
        yanchor: "bottom",
        font: {
          family: "Montserrat, sans-serif",
          size: 9,
          color: "rgba(0,0,0,0.7)"
        }
      },
      {
        x: capacities[highlightIndex],
        y: sellThrough[highlightIndex],
        xref: "x",
        yref: "y",
        text: "Servette: big house,\nlow utilization",
        showarrow: true,
        arrowhead: 2,
        arrowsize: 0.6,
        ax: 40,
        ay: -40,
        font: {
          family: "Montserrat, sans-serif",
          size: 9,
          color: "#07385E"
        },
        arrowcolor: "rgba(7,56,94,0.6)"
      }
    ]
  };

  const config = { responsive: true, displayModeBar: false };

  Plotly.newPlot("swiss-league-plot", [clubsTrace, line100Trace], layout, config);
</script>
